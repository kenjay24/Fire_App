{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>{% block title %}FireApp{% endblock %}</title>
  <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport" />
  <link rel="icon" href="{% static 'img/icon.ico' %}" type="image/x-icon" />
  
  <!-- Toast container -->
  <div id="toast-container" aria-live="polite" aria-atomic="true" style="position: fixed; bottom: 20px; right: 20px; z-index: 1050; min-width: 300px;">
    <!-- Toasts will be dynamically inserted here -->
  </div>

  <!-- Fonts and icons -->
  <script src="{% static 'js/plugin/webfont/webfont.min.js' %}"></script>
  <script>
    WebFont.load({
      google: { families: ["Lato:300,400,700,900"] },
      custom: { 
        families: ["Flaticon", "Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands", "simple-line-icons"], 
        urls: ["{% static 'css/fonts.min.css' %}"] 
      },
      active: function() {
        sessionStorage.fonts = true;
      },
    });
  </script>

  <!-- CSS Files -->
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
  <link rel="stylesheet" href="{% static 'css/atlantis.min.css' %}" />
  <link rel="stylesheet" href="{% static 'css/demo.css' %}" />
</head>
<body>
  <div class="wrapper">
    <div class="main-header">
      <!-- Logo Header -->
      <div class="logo-header" data-background-color="blue">
        <a href="index.html" class="logo">
          <img src="{% static 'img/logo.svg' %}" alt="navbar brand" class="navbar-brand" />
        </a>
        <button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse" data-target="collapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon">
            <i class="icon-menu"></i>
          </span>
        </button>
        <button class="topbar-toggler more"><i class="icon-options-vertical"></i></button>
        <div class="nav-toggle">
          <button class="btn btn-toggle toggle-sidebar">
            <i class="icon-menu"></i>
          </button>
        </div>
      </div>
      <!-- End Logo Header -->

      <!-- Navbar Header -->
      <nav class="navbar navbar-header navbar-expand-lg" data-background-color="blue2">
        <div class="container-fluid">
          <div class="collapse" id="search-nav"></div>
          <ul class="navbar-nav topbar-nav ml-md-auto align-items-center"></ul>
        </div>
      </nav>
      <!-- End Navbar -->
    </div>

    <!-- Sidebar -->
    <div class="sidebar sidebar-style-2">
      <div class="sidebar-wrapper scrollbar scrollbar-inner">
        <div class="sidebar-content">
          <div class="user">
            <div class="avatar-sm float-left mr-2">
              <img src="{% static 'img/mlane.jpg' %}" alt="..." class="avatar-img rounded-circle" />
            </div>
            <div class="info">
              <a data-toggle="collapse" href="#collapseExample" aria-expanded="true">
                <span>
                  Baham Kenjay
                  <span class="user-level">Administrator</span>
                  <span class="caret"></span>
                </span>
              </a>
              <div class="clearfix"></div>

              <div class="collapse in" id="collapseExample">
                <ul class="nav">
                  <li>
                    <a href="#profile">
                      <span class="link-collapse">My Profile</span>
                    </a>
                  </li>
                  <li>
                    <a href="#edit">
                      <span class="link-collapse">Edit Profile</span>
                    </a>
                  </li>
                  <li>
                    <a href="#settings">
                      <span class="link-collapse">Settings</span>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <ul class="nav nav-primary">
            <li class="nav-item active">
              <a data-toggle="collapse" href="#dashboard" class="collapsed" aria-expanded="false">
                <i class="fas fa-home"></i>
                <p>Dashboard</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="dashboard">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="{% url 'dashboard-chart' %}">
                      <span class="sub-item">Dashboard 1</span>
                    </a>
                  </li>
                  <li>
                    <a href="{% url 'dashboard-chart' %}">
                      <span class="sub-item">Dashboard 2</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-section">
              <span class="sidebar-mini-icon">
                <i class="fa fa-ellipsis-h"></i>
              </span>
              <h4 class="text-section">Components</h4>
            </li>
            <li class="nav-item">
              <a data-toggle="collapse" href="#base">
                <i class="fas fa-layer-group"></i>
                <p>Base</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="base">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="components/avatars.html">
                      <span class="sub-item">Avatars</span>
                    </a>
                  </li>
                  <li>
                    <a href="components/buttons.html">
                      <span class="sub-item">Buttons</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-item">
              <a data-toggle="collapse" href="#maps">
                <i class="fas fa-map-marker-alt"></i>
                <p>Maps</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="maps">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="{% url 'map-station' %}">
                      <span class="sub-item">Fire Stations</span>
                    </a>
                  </li>
                  <li>
                    <a href="{% url 'fire-incidents-map' %}">
                      <span class="sub-item">Fire Incidents</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-item">
              <a href="{% url 'station-list' %}">
                <i class="fas fa-fire-extinguisher"></i>
                <p>Fire Stations</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="{% url 'incident-list' %}">
                <i class="fas fa-fire"></i>
                <p>Incidents</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="{% url 'loc-list' %}">
                <i class="fas fa-map-signs"></i>
                <p>Location</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="{% url 'weather-list' %}">
                <i class="fas fa-cloud" style="color: gray;"></i>
                <p>Weather Conditions</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="{% url 'fireTruck-list' %}">
                <i class="fas fa-truck" style="color: gray;"></i>
                <p>FireTruck</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="{% url 'firefighters-list' %}">
                <i class="fas fa-fire" style="color: gray;"></i>
                <p>Firefighters</p>
              </a>
            </li>          
            <li class="nav-item">
              <a data-toggle="collapse" href="#charts">
                <i class="far fa-chart-bar"></i>
                <p>Charts</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="charts">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="{% url 'dashboard-chart' %}">
                      <span class="sub-item">Chart Js</span>
                    </a>
                  </li>
                  <li>
                    <a href="charts/sparkline.html">
                      <span class="sub-item">Sparkline</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-item">
              <a href="widgets.html">
                <i class="fas fa-desktop"></i>
                <p>Widgets</p>
                <span class="badge badge-success">4</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <!-- End Sidebar -->

    <div class="main-panel">
      <div class="content">
        {% block content %}
        {% endblock %}
      </div>
    </div>
  </div>
  
  <!-- Core JS Files -->
  <script src="{% static 'js/core/jquery.3.2.1.min.js' %}"></script>
  <script src="{% static 'js/core/popper.min.js' %}"></script>
  <script src="{% static 'js/core/bootstrap.min.js' %}"></script>

  <!-- jQuery UI -->
  <script src="{% static 'js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js' %}"></script>
  <script src="{% static 'js/plugin/jquery-ui-touch-punch/jquery.ui.touch-punch.min.js' %}"></script>
  <script src="{% static 'js/plugin/jquery-scrollbar/jquery.scrollbar.min.js' %}"></script>
  
  <!-- Plugins -->
  <script src="{% static 'js/plugin/chart.js/chart.min.js' %}"></script>
  <script src="{% static 'js/plugin/jquery.sparkline/jquery.sparkline.min.js' %}"></script>
  <script src="{% static 'js/plugin/chart-circle/circles.min.js' %}"></script>
  <script src="{% static 'js/plugin/datatables/datatables.min.js' %}"></script>
  <script src="{% static 'js/plugin/bootstrap-notify/bootstrap-notify.min.js' %}"></script>
  <script src="{% static 'js/plugin/jqvmap/jquery.vmap.min.js' %}"></script>
  <script src="{% static 'js/plugin/jqvmap/maps/jquery.vmap.world.js' %}"></script>
  <script src="{% static 'js/plugin/sweetalert/sweetalert.min.js' %}"></script>
  <script src="{% static 'js/atlantis.min.js' %}"></script>

  {% block chart %}{% endblock %}

  <!-- Toast Messages Handling -->
  <div id="toast-container" aria-live="polite" aria-atomic="true" style="position: fixed; bottom: 20px; right: 20px; z-index: 1050; display: flex; flex-direction: column-reverse; gap: 12px;">
    <!-- Toasts will be dynamically inserted here -->
  </div>

  {% if messages %}
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Toast color schemes with modern design
      const toastThemes = {
        'success': {
          bg: 'bg-gradient-success',
          text: 'text-white',
          icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>',
          progress: 'bg-white'
        },
        'error': {
          bg: 'bg-gradient-danger',
          text: 'text-white',
          icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',
          progress: 'bg-white'
        },
        'warning': {
          bg: 'bg-gradient-warning',
          text: 'text-dark',
          icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12" y2="17"></line></svg>',
          progress: 'bg-dark'
        },
        'info': {
          bg: 'bg-gradient-info',
          text: 'text-white',
          icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',
          progress: 'bg-white'
        },
        'default': {
          bg: 'bg-gradient-dark',
          text: 'text-white',
          icon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bell"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>',
          progress: 'bg-white'
        }
      };
    
      {% for message in messages %}
        // Get appropriate theme based on message tags
        const tags = "{{ message.tags|default:'default' }}".split(' ');
        const theme = toastThemes[tags[0]] || toastThemes['default'];
        
        // Create toast with modern design
        const toastHTML = `
        <div class="toast show mb-3" role="alert" aria-live="assertive" aria-atomic="true" 
             style="border: none; border-radius: 12px; overflow: hidden; box-shadow: 0 6px 20px rgba(0,0,0,0.15); backdrop-filter: blur(10px);">
          <div class="toast-header ${theme.bg} ${theme.text} p-3" style="border: none; position: relative;">
            <div class="toast-icon me-3" style="width: 24px; height: 24px;">${theme.icon}</div>
            <strong class="me-auto">Notification</strong>
            <small class="text-white-50">Just now</small>
            <button type="button" class="btn-close btn-close-white ms-2" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
          <div class="toast-body p-3 ${theme.text}" style="background: rgba(0,0,0,0.1);">
            ${"{{ message|escapejs }}"}
          </div>
          <div class="toast-progress ${theme.progress}" style="height: 3px; width: 100%;"></div>
        </div>`;
        
        // Append toast with entrance animation
        document.getElementById('toast-container').insertAdjacentHTML('afterbegin', toastHTML);
        const toastElement = document.getElementById('toast-container').firstElementChild;
        
        // Add exit animation when closing
        toastElement.addEventListener('hidden.bs.toast', function() {
          toastElement.style.transition = 'all 0.3s ease';
          toastElement.style.opacity = '0';
          toastElement.style.transform = 'translateX(100%) scale(0.9)';
          setTimeout(() => toastElement.remove(), 300);
        });
        
        // Auto-hide after delay with progress animation
        const toast = new bootstrap.Toast(toastElement, { 
          delay: 5000,
          animation: true
        });
        toast.show();
        
        // Animate progress bar
        const progressBar = toastElement.querySelector('.toast-progress');
        progressBar.style.transition = 'width 5s linear';
        setTimeout(() => {
          progressBar.style.width = '0%';
        }, 50);
      {% endfor %}
    });
    
    // Add CSS for modern animations and gradients
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
      .toast {
        animation: fadeIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        transition: all 0.3s ease;
      }
      .bg-gradient-success {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
      }
      .bg-gradient-danger {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
      }
      .bg-gradient-warning {
        background: linear-gradient(135deg, #f39c12, #d35400);
      }
      .bg-gradient-info {
        background: linear-gradient(135deg, #3498db, #2980b9);
      }
      .bg-gradient-dark {
        background: linear-gradient(135deg, #34495e, #2c3e50);
      }
      .toast-icon svg {
        vertical-align: middle;
      }
    `;
    document.head.appendChild(style);
</script>
  {% endif %}
</body>
</html>